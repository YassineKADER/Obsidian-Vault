- **Classe**: DBA
- **Sujet**: Notes de Cours
- **Sous-thème**: Options d'Arrêt

Notes :
  - Arrêt :
    - Abort : arrêt sur place + <mark style="background: #FFB8EBA6;">possibilité de récupérer les données</mark>.
    - Immediate : arrêt sur place.
    - Transactional : arrêt lorsque ==la validation/annulation des transactions==.
    - Normal : quitter sur place.
  - Init.ora :
    - <mark style="background: #FFB86CA6;">dba_user</mark> //database contient toutes les informations de tous les utilisateurs.

- **Requêtes SQL** :
  - Question 1 :
    - GRANT UPDATE (adresse) ON emp TO Ali;
    - GRANT INSERT (nemp, nom, prenom) ON emp TO Ali;
  - Question 2 :
    - GRANT CONNECT TO lila WITH ADMIN OPTION;
    - GRANT RESOURCE TO laila WITH ADMIN OPTION;
  - Question 3 :
    - CREATE ROLE R;
    - GRANT ALL PRIVILEGES ON emp TO R;
    - GRANT CREATE SESSION, CREATE ANY TABLE TO R;
  - Question 4 :
    - GRANT R TO Khalid WITH ADMIN OPTION;

- **TP 1**: Gestion d’Instance et de Base de données ORACLE
  - Options de Démarrage :
    - startup : <mark style="background: #FFF3A3A6;">Démarrage normal.</mark>
    - startup nomount : Démarre l'instance <mark style="background: #BBFABBA6;">sans monter la base de données.</mark>
    - startup mount : Démarre l'instance<mark style="background: #ABF7F7A6;"> et monte la base de données</mark>.
    - startup force : Démarre la base de données <mark style="background: #D2B3FFA6;">même si elle est dans un état inconsistent</mark>.
  - Options d'Arrêt :
    - shutdown normal : Attend que <mark style="background: #ADCCFFA6;">les transactions actives se terminent</mark>.
    - shutdown immediate : Arrête<mark style="background: #ADCCFFA6;"> immédiatement la base de données</mark>.
    - shutdown transactional : Arrête <mark style="background: #BBFABBA6;">après la validation des transactions actives</mark>.
    - shutdown abort : <mark style="background: #BBFABBA6;">Arrête brusquement la base de données</mark>.
  - Se Connecter en tant que SYS et Arrêter la Base de Données :
    - sqlplus sys / as sysdba
    - shutdown;
  - Se Connecter en tant que SYS et Démarrer la Base de Données avec un PFILE :
    - sqlplus sys / as sysdba
    - startup <mark style="background: #CACFD9A6;">pfile=init.ora</mark>;
  - Arrêter la Base de Données et l'Ouvrir en Mode Lecture Seule :
    - shutdown immediate;
    - startup mount;
    - alter <mark style="background: #FF5582A6;">database open read only</mark>;
  - Se Connecter en tant que HR, Voir le Contenu de la Table :
    - sqlplus hr/hr
    - select * from regions;
  - Insérer une Ligne dans la Table REGIONS en tant qu'Utilisateur HR :
    - insert into regions values (...);
  - Passer la Base de Données en Mode Lecture-Écriture :
    - shutdown immediate;
    - startup;
  - Insérer une Ligne dans la Table REGIONS sans Commiter :
    - Insérer une ligne sans commiter.
  - Démarrer SQL*Plus en tant que SYSDBA et Effectuer un Arrêt Transactionnel :
    - sqlplus sys / as sysdba
    - shutdown transactional;
  - Annuler l'Insertion de la Session HR, Puis Quitter :
    - Rollback de l'insertion dans la session HR.
    - Vérifier l'impact dans les sessions HR et SYS.
  - Se Connecter en tant que SYS et Démarrer la Base de Données :
    - sqlplus sys / as sysdba
    - startup;
  - Démarrer une Autre Session en tant qu'Utilisateur HR.
  - Activer la Session Restreinte en tant que SYS :
  - Tenter une Opération de Sélection dans la Session HR.
  - Se Reconnecter en tant qu'Utilisateur HR et Observer.
  - Désactiver la Session Restreinte en tant que SYS.

- **TP 1**: Gestion des utilisateurs, privilèges et rôles
  - Ouvrir une Session SQL*Plus en tant qu'utilisateur_isil et Afficher le Nom d'Utilisateur :
    - Commande : sqlplus user_isil/password
    - Réponse : Connecté à la base de données Oracle en tant qu'UTILISATEUR_ISIL
  - Dans la Session utilisateur_isil, Vérifier les Privilèges sur les Objets Accordés :
    - Commande : select * from user_tab_privs;
  - Dans la Session utilisateur_isil, Vérifier les Privilèges Système Accordés :
    - Commande : select * from user_sys_privs;
  - Dans la Session utilisateur_isil, Vérifier les Rôles Accordés :
    - Commande : select * from user_role_privs;
  - Afficher le Contenu de la Table emp_isil :
    - Commande : select * from emp_isil;
  - Dans la Session Nom_isil, Créer la Table service :
    - create table service ( id number, libelle varchar(15) );
  - Dans la Session système, Supprimer le Privilège 'CREATE TABLE' du Rôle R_isil :
    - Commande : revoke create table from R_isil;
  - Vérifier les Privilèges Mis à Jour du Rôle R_isil :
    - Commande : select * from dba_sys_privs where grantee = 'R_ISIL';
  - Dans la Session Nom_isil, Créer la Table emp :
    - create table emp ( id_emp, nom, prenom, salaire );
  - Révoquer le Rôle de l'Utilisateur Nom_isil :
    - Commande : revoke R_isil from Nom_isil;
  - Dans la Session Nom_isil, Afficher les Rôles Accordés :
    - Commande : select * from session_roles;
  - Accorder le Rôle R_isil à Tous les Utilisateurs de la Base de Données :
    - Commande : grant R_isil to public;
  - Vérifier les Rôles Mis à Jour Accordés à l'Utilisateur Nom_isil :
    - Commande : select * from user_role_privs where grantee = 'NOM_ISIL';
  - Révoquer le Rôle de l'Utilisateur Nom_isil :
    - Commande : revoke R_isil from Nom_isil;
  - Depuis la Session système, Accorder le Droit de Modification du Salaire à l'Utilisateur Nom_isil :
    - Commande : grant update (salaire) on emp_isil to Nom_isil;
  - Dans la Session Nom_isil, Tenter la Modification du Salaire :
    - Commande : update emp_isil set salaire = salaire + 500 where ...;
  - Afficher les Privilèges au Niveau des Colonnes Accordés à l'Utilisateur Nom_isil :
    - Commande : select table_name, column_name, privilege from user_tab_privs where grantee = 'NOM_ISIL';

Commande Additionnelle

 pour la Création d'Utilisateur :
  - Commande : CREATE USER nom_utilisateur IDENTIFIED BY mot_de_passe;
    - Remplacez 'nom_utilisateur' par le nom d'utilisateur souhaité et 'mot_de_passe' par le mot de passe souhaité.
